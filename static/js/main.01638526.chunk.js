/*! For license information please see main.01638526.chunk.js.LICENSE */
(this.webpackJsonpdrumixfy=this.webpackJsonpdrumixfy||[]).push([[0],{24:function(e,t,n){e.exports=n(63)},53:function(e,t){},54:function(e,t){},55:function(e,t){},56:function(e,t){},57:function(e,t){},58:function(e,t){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(4),i=n(5),s=n(7),c=n(6),l=n(8),u=n(1),p=n.n(u),d=n(20),m=n.n(d);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var f=n(21),h=n.n(f),v=n(3),g=v.sequences.quantizeNoteSequence,y=v.sequences.clone,b=16,q=4;function w(e,t){var n,a,o,i,s,c,l,u=arguments;return r.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:n=u.length>2&&void 0!==u[2]?u[2]:1,e=g(e,q),a=t.length*b,o=1/v.sequences.stepsPerQuarterToStepsPerSecond(q,e.tempos[0].qpm),i=[],s=function(s){var c,l,u,p,d,m;return r.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return c=y(e),l=Math.min(s+a,e.totalQuantizedSteps),c.notes=e.notes.map((function(e){return Object.assign({},e)})).filter((function(e){return s<=e.quantizedStartStep&&e.quantizedStartStep<l})).map((function(e){return e.startTime-=s*o,e.endTime-=s*o,e.quantizedStartStep-=s,e.quantizedEndStep-=s,e})),c.totalQuantizedSteps=l-s,c.totalTime=c.totalQuantizedSteps*o,u=Math.ceil(c.totalQuantizedSteps/b),p=u-1,f.next=9,r.a.awrap(t[p].encode([c]));case 9:return d=f.sent,f.next=12,r.a.awrap(t[p].decode(d,n,void 0,void 0,e.tempos[0].qpm));case 12:m=f.sent,d.dispose(),i.push(m[0]);case 15:case"end":return f.stop()}}))},c=0;case 7:if(!(c<e.totalQuantizedSteps)){p.next=13;break}return p.next=10,r.a.awrap(s(c));case 10:c+=a,p.next=7;break;case 13:return l=j.apply(void 0,i),p.abrupt("return",l);case 15:case"end":return p.stop()}}))}function j(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2===t.length){var a=t[0],r=t[1],o=y(a);return r.notes.forEach((function(e){var t=Object.assign({},e);t.startTime+=a.totalTime,t.endTime+=a.totalTime,o.notes.push(t)})),o.totalTime=a.totalTime+r.totalTime,o}return t.length>2?j(t.shift(),j.apply(void 0,t)):t[0]}var k="http://storage.googleapis.com/magentadata/js/checkpoints/",O=function(){function e(){Object(o.a)(this,e);var t=[k+"groovae/tap2drum_1bar",k+"groovae/tap2drum_2bar",k+"groovae/tap2drum_3bar",k+"groovae/tap2drum_4bar"];this.models=t.map((function(e){return new v.MusicVAE(e)}))}return Object(i.a)(e,[{key:"load",value:function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(this.model.initialize());case 3:t.next=10;break;case 5:t.prev=5,t.t0=t.catch(0),(e=document.createElement("magenta-snackbar")).setAttribute("message",t.t0),document.body.appendChild(e);case 10:case"end":return t.stop()}}),null,this,[[0,5]])}},{key:"drumify",value:function(e){var t,n=arguments;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=n.length>1&&void 0!==n[1]?n[1]:1,a.next=3,r.a.awrap(w(e,this.models,t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}}]),e}(),E=(n(60),n(61),n(23)),x=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).seq=e.seq,n.ref=p.a.createRef(),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.pianoRoll=new v.PianoRollSVGVisualizer(this.seq,this.ref.current)}},{key:"render",value:function(){return p.a.createElement("svg",{ref:this.ref})}}]),t}(p.a.Component),S=n(12),T=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).player=e.player,n.seq=e.seq,n.onTogglePlay=e.onTogglePlay,n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return p.a.createElement(S.a,{variant:"primary",onClick:function(){return t=e.seq,console.log(t),e.player.isPlaying()?e.player.stop():e.player.start(t),void e.onTogglePlay();var t}},this.player.isPlaying()?"stop":"play")}}]),t}(p.a.Component),P=(n(62),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isPlaying:!1},n.onTogglePlay=function(){n.setState({isPlaying:n.player.isPlaying()})},n.player=new v.Player(!1,{run:function(){},stop:n.onTogglePlay}),n.sequences=e.sequences,n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.sequences.length>0?p.a.createElement(T,{seq:function(e){var t=Object.assign({},e[0]),n=[];return e.forEach((function(e){n.push.apply(n,Object(E.a)(e.notes))})),t.notes=n,t}(this.props.sequences),player:this.player,onTogglePlay:this.onTogglePlay}):"";return p.a.createElement("div",{className:"tracks container"},this.props.sequences.map((function(t,n){return p.a.createElement("div",{className:"row",key:n},p.a.createElement("div",{className:"col-1 my-auto"},p.a.createElement(T,{seq:t,player:e.player,onTogglePlay:e.onTogglePlay}),p.a.createElement("p",{className:"origin-info"},t.trackInfo.origin)),p.a.createElement("div",{className:"col-11 track "+t.trackInfo.origin},p.a.createElement(x,{seq:t}),"drumify"==t.trackInfo.origin?p.a.createElement(S.a,null,"mix"):""))})),p.a.createElement("div",{className:"row"+(this.props.sequences.length>0?"":" d-none")},t))}}]),t}(p.a.Component)),z=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isFileLoaded:!1,isPlaying:!1},n.model=new O,n.model.load(),n.player=new v.Player,n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"container"},p.a.createElement(h.a,{className:"files-dropzone row"+(this.state.isFileLoaded?"":" no-files-droped"),dropActiveClassName:"drop-active",onChange:function(t){v.blobToNoteSequence(t[0]).then((function(t){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.seq=t,e.seq.trackInfo={origin:"file"},n.next=4,r.a.awrap(e.model.drumify(t,1));case 4:e.drums=n.sent,e.drums.trackInfo={origin:"drumify"},e.setState({isFileLoaded:!0});case 7:case"end":return n.stop()}}))}))},onError:function(e,t){console.log("error code "+e.code+": "+e.message)},accepts:["audio/*"],multiple:!0,maxFiles:3,maxFileSize:1e7,minFileSize:0,clickable:!0},p.a.createElement("div",{className:"col-12 text-center my-auto"},"Drop files here or click to upload")),p.a.createElement(P,{sequences:[this.seq,this.drums].filter((function(e){return void 0!==e}))}))}}]),t}(p.a.Component);m.a.render(p.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[24,1,2]]]);
//# sourceMappingURL=main.01638526.chunk.js.map